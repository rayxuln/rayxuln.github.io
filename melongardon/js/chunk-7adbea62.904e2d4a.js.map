{"version":3,"sources":["webpack:///./src/views/PostPage.vue","webpack:///./src/components/PostPageLevel.vue","webpack:///./src/components/PostPageLevel.vue?6149","webpack:///./src/plugins/prism_wrap.js","webpack:///./src/views/PostPage.vue?6892","webpack:///./src/views/PostPage.vue?0f87","webpack:///./src/components/PostPageLevel.vue?3c5f","webpack:///./src/views/PostPage.vue?7b86"],"names":["class","shadow","title","content","$router","push","base_url","levelList","l","key","level","userAvatarUrl","userName","date","isPoster","isYou","onReplyTextClicked","levelNum","isLoadingPage","background","layout","page-size","pageSize","page-count","current-page","currentPage","total","filteredLevelNum","onCurrentPageChanged","replyBoxTextArea","type","onReply","ref","size","shape","src","$emit","canDelete","props","String","Number","Boolean","emits","computed","this","mounted","$refs","innerHTML","watch","newValue","render","PrismHighlightAll","Prism","highlightAll","components","RichTextEditor","data","postId","created","$watch","$route","query","path","loadLevels","methods","APIs","reply","then","success","newPage","Math","ceil","catch","e","error","window","scroll","top","document","body","clientHeight","left","behavior","post_id","parseInt","page","filter","search","getPostInfo","value","v","getPostLevelList","levels","$nextTick","pageNumber","r","hash","params"],"mappings":"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","file":"js/chunk-7adbea62.904e2d4a.js","sourcesContent":["<template>\n  <div class=\"post-page\">\n    <el-card shadow=\"never\" class=\"post-page-body\">\n    <div v-loading=\"isLoadingPage\">\n    <!--div class=\"post-page-title\">{{ title }}</div-->\n    <el-page-header title=\"\" :content=\"title\" @back=\"$router.push(base_url)\"></el-page-header>\n\n    <div class=\"post-page-level-container\" v-for=\"l in levelList\" :key=\"l.level\">\n      <post-page-level\n        :userAvatarUrl=\"l.userAvatarUrl\"\n        :userName=\"l.userName\"\n        :level=\"l.level\"\n        :content=\"l.content\"\n        :date=\"l.date\"\n        :isPoster=\"l.isPoster\"\n        :isYou=\"l.isYou\"\n        @replyTextClick=\"onReplyTextClicked\">\n      </post-page-level>\n    </div>\n\n    <div class=\"post-page-tail\">Replies: {{ levelNum }}</div>\n\n    </div>\n    </el-card>\n\n    <el-pagination\n      background\n      layout=\"prev, pager, next, jumper\"\n      :page-size=\"pageSize\"\n      :page-count=\"5\"\n      :current-page=\"currentPage\"\n      :total=\"filteredLevelNum\"\n      @current-change=\"onCurrentPageChanged\">\n    </el-pagination>\n\n    <el-card shadow=\"never\">\n    <div class=\"reply-box-container\">\n      <div class=\"reply-box-title\">Reply</div>\n      <rich-text-editor v-model=\"replyBoxTextArea\"></rich-text-editor>\n      <el-button type=\"primary\" @click=\"onReply\">Reply</el-button>\n    </div>\n    </el-card>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport APIs from '@/APIs'\nimport { Options, Vue } from 'vue-class-component'\nimport RichTextEditor from '@/components/RichTextEditor.vue'\nimport PostPageLevel from '@/components/PostPageLevel.vue'\nimport { ElMessage } from 'element-plus'\nimport { PrismHighlightAll } from '@/plugins/prism_wrap'\n\n@Options({\n  components: {\n    'rich-text-editor': RichTextEditor,\n    'post-page-level': PostPageLevel\n  },\n  data () {\n    return {\n      title: '',\n      postId: '',\n      currentPage: 1,\n      replyBoxTextArea: '',\n      isLoadingPage: false,\n      levelList: [],\n      levelNum: 0,\n      filteredLevelNum: 0,\n      pageSize: 2,\n      base_url: process.env.BASE_URL\n    }\n  },\n  created () {\n    this.$watch(\n      () => this.$route.query,\n      () => {\n        if (this.$route.path === `${this.base_url}post`) {\n          this.loadLevels()\n        }\n      }\n    )\n  },\n  mounted () {\n    this.loadLevels()\n  },\n  methods: {\n    onReply () {\n      if (this.replyBoxTextArea === '') {\n        ElMessage.error('The reply content mustn\\'t be empty!')\n        return\n      }\n\n      APIs.reply(this.postId, this.replyBoxTextArea).then(() => {\n        ElMessage.success('You\\'ve just replied in a post')\n        this.replyBoxTextArea = ''\n        const newPage = Math.ceil((this.levelNum + 1) / this.pageSize)\n        if (this.currentPage !== newPage) {\n          this.$router.push(`/post?post_id=${this.postId}&page=${newPage}`)\n        } else {\n          this.loadLevels()\n        }\n      }).catch((e) => {\n        ElMessage.error('Can\\'t reply. ' + e)\n      })\n    },\n    onReplyTextClicked () {\n      window.scroll({ top: document.body.clientHeight, left: 0, behavior: 'smooth' })\n    },\n    loadLevels () {\n      this.postId = this.$route.query.post_id\n      let currentPage = Number.parseInt(this.$route.query.page)\n      if (!currentPage) {\n        currentPage = 1\n      }\n      const filter = this.$route.query.search || ''\n\n      this.isLoadingPage = true\n\n      APIs.getPostInfo(this.postId).then((value) => {\n        const v = value as {levelNum:number, title:string}\n        this.levelNum = v.levelNum\n        this.title = v.title\n        if (this.currentPage !== currentPage) {\n          this.currentPage = -1\n        }\n        return APIs.getPostLevelList(this.postId, this.pageSize, currentPage, filter)\n      }).then((value) => {\n        const v = value as { levels:unknown, levelNum:number }\n        this.levelList = v.levels\n        this.filteredLevelNum = v.levelNum\n        this.currentPage = currentPage\n\n        this.$nextTick(() => {\n          PrismHighlightAll()\n        })\n      }).catch((e) => {\n        ElMessage.error('Error happing while loading post page. ' + e)\n      }).then(() => {\n        this.isLoadingPage = false\n      })\n    },\n    onCurrentPageChanged (pageNumber:number) {\n      const r = {\n        path: this.$route.path,\n        query: { ...this.$route.query, page: pageNumber },\n        hash: this.$route.hash,\n        params: { ...this.$route.params }\n      }\n      this.$router.push(r)\n    }\n  }\n})\nexport default class PostPage extends Vue {}\n</script>\n\n<style scope>\n.post-page{\n  text-align: left;\n}\n\n.post-page-body{\n  margin-bottom: 15px;\n}\n\n.post-page-title{\n  font-size: 24px;\n  margin-bottom: 15px;\n}\n\n.post-page-tail{\n  margin-top: 5px;\n  margin-bottom: -5px;\n}\n\n.el-pagination{\n  margin-bottom: 15px;\n  text-align: center;\n}\n\n.reply-box-container{\n  text-align: left;\n}\n\n.reply-box-container > div{\n  margin-bottom: 15px;\n}\n\n.reply-box-title{\n  font-size: 32px;\n  margin: 5px;\n}\n\n.el-page-header{\n  margin-bottom: 15px;\n}\n\n</style>\n","<template>\n  <div class=\"post-page-level\">\n  <el-card shadow=\"never\">\n    <div class=\"level-box\">\n      <div class=\"level-box-left\">\n        <div class=\"level-box-user-avatar\"><el-avatar size=\"large\" shape=\"square\" :src=\"userAvatarUrl\"></el-avatar></div>\n        <div class=\"level-box-user-name-container\">\n          <div class=\"level-box-user-name\">{{ userName }}</div>\n          <div v-if=\"isPoster\"><el-tag class=\"poster-tag\" type=\"warning\">Poster</el-tag></div>\n          <div v-if=\"isYou\"><el-tag>You</el-tag></div>\n        </div>\n      </div>\n      <div class=\"level-box-right\">\n        <div class=\"level-box-content\" ref=\"content\"></div>\n        <div class=\"level-box-corner\">\n          <span> L{{ level }} {{ date }}\n            <el-link type=\"primary\" @click.prevent=\"$emit('replyTextClick')\">Reply</el-link>\n            <span v-if=\"isYou\"> | <el-link type=\"primary\" @click.prevent>Edit</el-link></span>\n            <span v-if=\"canDelete\"> | <el-link type=\"primary\" @click.prevent>Delete</el-link></span>\n          </span>\n        </div>\n      </div>\n    </div>\n  </el-card>\n  </div>\n</template>\n\n<script>\nimport { Options, Vue } from 'vue-class-component'\n\n@Options({\n  props: {\n    userAvatarUrl: String,\n    userName: String,\n    content: String,\n    level: Number,\n    date: String,\n    isPoster: Boolean,\n    isYou: Boolean\n  },\n  emits: ['replyTextClick'],\n  computed: {\n    canDelete () {\n      return this.isYou\n    }\n  },\n  mounted () {\n    this.$refs.content.innerHTML = this.content\n  },\n  watch: {\n    content (newValue) {\n      this.$refs.content.innerHTML = newValue\n    }\n  }\n})\nexport default class PostPageLevel extends Vue {}\n</script>\n\n<style scope>\n.level-box{\n  display: flex;\n  flex-direction: row;\n  justify-items: stretch;\n  align-items: stretch;\n  margin: -20px;\n}\n\n.level-box-left{\n  background-color: rgb(247, 249, 251);\n  min-height: 300px;\n  border-right: 1px solid #EBEEF5;\n}\n\n.level-box-right{\n  width: 100%;\n  padding: 15px;\n  display: flex;\n  flex-direction: column;\n}\n\n.level-box-user-avatar{\n  margin: 50px;\n  margin-top: 75px;\n  margin-bottom: 15px;\n}\n\n.level-box-user-name-container{\n  text-align: center;\n}\n\n.level-box-user-name{\n  margin-bottom: 15px;\n}\n\n.level-box-corner{\n  margin-top: auto;\n  text-align: right;\n}\n\n</style>\n","import { render } from \"./PostPageLevel.vue?vue&type=template&id=f3e137fc\"\nimport script from \"./PostPageLevel.vue?vue&type=script&lang=js\"\nexport * from \"./PostPageLevel.vue?vue&type=script&lang=js\"\n\nimport \"./PostPageLevel.vue?vue&type=style&index=0&id=f3e137fc&scope=true&lang=css\"\nscript.render = render\n\nexport default script","/* eslint-disable */\nexport function PrismHighlightAll () {\n    Prism.highlightAll()\n}\n","\nimport APIs from '@/APIs'\nimport { Options, Vue } from 'vue-class-component'\nimport RichTextEditor from '@/components/RichTextEditor.vue'\nimport PostPageLevel from '@/components/PostPageLevel.vue'\nimport { ElMessage } from 'element-plus'\nimport { PrismHighlightAll } from '@/plugins/prism_wrap'\n\n@Options({\n  components: {\n    'rich-text-editor': RichTextEditor,\n    'post-page-level': PostPageLevel\n  },\n  data () {\n    return {\n      title: '',\n      postId: '',\n      currentPage: 1,\n      replyBoxTextArea: '',\n      isLoadingPage: false,\n      levelList: [],\n      levelNum: 0,\n      filteredLevelNum: 0,\n      pageSize: 2,\n      base_url: process.env.BASE_URL\n    }\n  },\n  created () {\n    this.$watch(\n      () => this.$route.query,\n      () => {\n        if (this.$route.path === `${this.base_url}post`) {\n          this.loadLevels()\n        }\n      }\n    )\n  },\n  mounted () {\n    this.loadLevels()\n  },\n  methods: {\n    onReply () {\n      if (this.replyBoxTextArea === '') {\n        ElMessage.error('The reply content mustn\\'t be empty!')\n        return\n      }\n\n      APIs.reply(this.postId, this.replyBoxTextArea).then(() => {\n        ElMessage.success('You\\'ve just replied in a post')\n        this.replyBoxTextArea = ''\n        const newPage = Math.ceil((this.levelNum + 1) / this.pageSize)\n        if (this.currentPage !== newPage) {\n          this.$router.push(`/post?post_id=${this.postId}&page=${newPage}`)\n        } else {\n          this.loadLevels()\n        }\n      }).catch((e) => {\n        ElMessage.error('Can\\'t reply. ' + e)\n      })\n    },\n    onReplyTextClicked () {\n      window.scroll({ top: document.body.clientHeight, left: 0, behavior: 'smooth' })\n    },\n    loadLevels () {\n      this.postId = this.$route.query.post_id\n      let currentPage = Number.parseInt(this.$route.query.page)\n      if (!currentPage) {\n        currentPage = 1\n      }\n      const filter = this.$route.query.search || ''\n\n      this.isLoadingPage = true\n\n      APIs.getPostInfo(this.postId).then((value) => {\n        const v = value as {levelNum:number, title:string}\n        this.levelNum = v.levelNum\n        this.title = v.title\n        if (this.currentPage !== currentPage) {\n          this.currentPage = -1\n        }\n        return APIs.getPostLevelList(this.postId, this.pageSize, currentPage, filter)\n      }).then((value) => {\n        const v = value as { levels:unknown, levelNum:number }\n        this.levelList = v.levels\n        this.filteredLevelNum = v.levelNum\n        this.currentPage = currentPage\n\n        this.$nextTick(() => {\n          PrismHighlightAll()\n        })\n      }).catch((e) => {\n        ElMessage.error('Error happing while loading post page. ' + e)\n      }).then(() => {\n        this.isLoadingPage = false\n      })\n    },\n    onCurrentPageChanged (pageNumber:number) {\n      const r = {\n        path: this.$route.path,\n        query: { ...this.$route.query, page: pageNumber },\n        hash: this.$route.hash,\n        params: { ...this.$route.params }\n      }\n      this.$router.push(r)\n    }\n  }\n})\nexport default class PostPage extends Vue {}\n","import { render } from \"./PostPage.vue?vue&type=template&id=5e6e4fe7\"\nimport script from \"./PostPage.vue?vue&type=script&lang=ts\"\nexport * from \"./PostPage.vue?vue&type=script&lang=ts\"\n\nimport \"./PostPage.vue?vue&type=style&index=0&id=5e6e4fe7&scope=true&lang=css\"\nscript.render = render\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PostPageLevel.vue?vue&type=style&index=0&id=f3e137fc&scope=true&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PostPage.vue?vue&type=style&index=0&id=5e6e4fe7&scope=true&lang=css\""],"sourceRoot":""}