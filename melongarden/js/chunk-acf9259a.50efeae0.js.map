{"version":3,"sources":["webpack:///./src/views/PostPage.vue","webpack:///./src/components/PostPageLevel.vue","webpack:///./src/components/PostPageLevel.vue?6149","webpack:///./src/views/PostPage.vue?6892","webpack:///./src/views/PostPage.vue?0f87","webpack:///./src/components/PostPageLevel.vue?3c5f","webpack:///./src/views/PostPage.vue?7118"],"names":["class","shadow","title","levelList","l","key","level","userAvatarUrl","userName","content","date","isPoster","isYou","onReplyTextClicked","levelNum","isLoadingPage","background","layout","page-size","pageSize","page-count","current-page","currentPage","total","onCurrentPageChanged","replyBoxTextArea","type","onReply","ref","size","shape","src","$emit","canDelete","props","String","Number","Boolean","emits","computed","this","mounted","$refs","innerHTML","watch","newValue","render","components","RichTextEditor","data","postId","created","$watch","$route","query","path","loadLevels","methods","APIs","reply","then","success","newPage","Math","ceil","$router","push","catch","e","error","window","scroll","top","document","body","clientHeight","left","behavior","post_id","parseInt","page","getPostInfo","value","v","getPostLevelList","pageNumber"],"mappings":"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","file":"js/chunk-acf9259a.50efeae0.js","sourcesContent":["<template>\n  <div class=\"post-page\">\n    <el-card shadow=\"never\" class=\"post-page-body\">\n    <div v-loading=\"isLoadingPage\">\n    <div class=\"post-page-title\">{{ title }}</div>\n\n    <div class=\"post-page-level-container\" v-for=\"l in levelList\" :key=\"l.level\">\n      <post-page-level\n        :userAvatarUrl=\"l.userAvatarUrl\"\n        :userName=\"l.userName\"\n        :level=\"l.level\"\n        :content=\"l.content\"\n        :date=\"l.date\"\n        :isPoster=\"l.isPoster\"\n        :isYou=\"l.isYou\"\n        @replyTextClick=\"onReplyTextClicked\">\n      </post-page-level>\n    </div>\n\n    <div class=\"post-page-tail\">Replies: {{ levelNum }}</div>\n\n    </div>\n    </el-card>\n\n    <el-pagination\n      background\n      layout=\"prev, pager, next, jumper\"\n      :page-size=\"pageSize\"\n      :page-count=\"5\"\n      :current-page=\"currentPage\"\n      :total=\"levelNum\"\n      @current-change=\"onCurrentPageChanged\">\n    </el-pagination>\n\n    <el-card shadow=\"never\">\n    <div class=\"reply-box-container\">\n      <div class=\"reply-box-title\">Reply</div>\n      <rich-text-editor v-model=\"replyBoxTextArea\"></rich-text-editor>\n      <el-button type=\"primary\" @click=\"onReply\">Reply</el-button>\n    </div>\n    </el-card>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport APIs from '@/APIs'\nimport { Options, Vue } from 'vue-class-component'\nimport RichTextEditor from '@/components/RichTextEditor.vue'\nimport PostPageLevel from '@/components/PostPageLevel.vue'\nimport { ElMessage } from 'element-plus'\n\n@Options({\n  components: {\n    'rich-text-editor': RichTextEditor,\n    'post-page-level': PostPageLevel\n  },\n  data () {\n    return {\n      title: '',\n      postId: '',\n      currentPage: 1,\n      replyBoxTextArea: '',\n      isLoadingPage: false,\n      levelList: [],\n      levelNum: 0,\n      pageSize: 2\n    }\n  },\n  created () {\n    this.$watch(\n      () => this.$route.query,\n      () => {\n        if (this.$route.path === '/post') {\n          this.loadLevels()\n        }\n      }\n    )\n  },\n  mounted () {\n    this.loadLevels()\n  },\n  methods: {\n    onReply () {\n      if (this.replyBoxTextArea === '') {\n        ElMessage.error('The reply content mustn\\'t be empty!')\n        return\n      }\n\n      APIs.reply(this.postId, this.replyBoxTextArea).then(() => {\n        ElMessage.success('You\\'ve just replied in a post')\n        this.replyBoxTextArea = ''\n        const newPage = Math.ceil((this.levelNum + 1) / this.pageSize)\n        if (this.currentPage !== newPage) {\n          this.$router.push(`/post?post_id=${this.postId}&page=${newPage}`)\n        } else {\n          this.loadLevels()\n        }\n      }).catch((e) => {\n        ElMessage.error('Can\\'t reply. ' + e)\n      })\n    },\n    onReplyTextClicked () {\n      window.scroll({ top: document.body.clientHeight, left: 0, behavior: 'smooth' })\n    },\n    loadLevels () {\n      this.postId = this.$route.query.post_id\n      let currentPage = Number.parseInt(this.$route.query.page)\n      if (!currentPage) {\n        currentPage = 1\n      }\n\n      this.isLoadingPage = true\n\n      APIs.getPostInfo(this.postId).then((value) => {\n        const v = value as {levelNum:number, title:string}\n        this.levelNum = v.levelNum\n        this.title = v.title\n        this.currentPage = currentPage\n        return APIs.getPostLevelList(this.postId, this.pageSize, this.currentPage)\n      }).catch((e) => {\n        ElMessage.error('Error happing while loading post page. ' + e)\n      }).then((v) => {\n        this.levelList = v\n      }).then(() => {\n        this.isLoadingPage = false\n      })\n    },\n    onCurrentPageChanged (pageNumber:number) {\n      this.$router.push(`/post?post_id=${this.postId}&page=${pageNumber}`)\n    }\n  }\n})\nexport default class PostPage extends Vue {}\n</script>\n\n<style scope>\n.post-page{\n  text-align: left;\n}\n\n.post-page-body{\n  margin-bottom: 15px;\n}\n\n.post-page-title{\n  font-size: 24px;\n  margin-bottom: 15px;\n}\n\n.post-page-tail{\n  margin-top: 5px;\n  margin-bottom: -5px;\n}\n\n.el-pagination{\n  margin-bottom: 15px;\n  text-align: center;\n}\n\n.reply-box-container{\n  text-align: left;\n}\n\n.reply-box-container > div{\n  margin-bottom: 15px;\n}\n\n.reply-box-title{\n  font-size: 32px;\n  margin: 5px;\n}\n\n</style>\n","<template>\n  <div class=\"post-page-level\">\n  <el-card shadow=\"never\">\n    <div class=\"level-box\">\n      <div class=\"level-box-left\">\n        <div class=\"level-box-user-avatar\"><el-avatar size=\"large\" shape=\"square\" :src=\"userAvatarUrl\"></el-avatar></div>\n        <div class=\"level-box-user-name-container\">\n          <div class=\"level-box-user-name\">{{ userName }}</div>\n          <div v-if=\"isPoster\"><el-tag class=\"poster-tag\" type=\"warning\">Poster</el-tag></div>\n          <div v-if=\"isYou\"><el-tag>You</el-tag></div>\n        </div>\n      </div>\n      <div class=\"level-box-right\">\n        <div class=\"level-box-content\" ref=\"content\"></div>\n        <div class=\"level-box-corner\">\n          <span> L{{ level }} {{ date }}\n            <el-link type=\"primary\" @click.prevent=\"$emit('replyTextClick')\">Reply</el-link>\n            <span v-if=\"isYou\"> | <el-link type=\"primary\" @click.prevent>Edit</el-link></span>\n            <span v-if=\"canDelete\"> | <el-link type=\"primary\" @click.prevent>Delete</el-link></span>\n          </span>\n        </div>\n      </div>\n    </div>\n  </el-card>\n  </div>\n</template>\n\n<script>\nimport { Options, Vue } from 'vue-class-component'\n\n@Options({\n  props: {\n    userAvatarUrl: String,\n    userName: String,\n    content: String,\n    level: Number,\n    date: String,\n    isPoster: Boolean,\n    isYou: Boolean\n  },\n  emits: ['replyTextClick'],\n  computed: {\n    canDelete () {\n      return this.isYou\n    }\n  },\n  mounted () {\n    this.$refs.content.innerHTML = this.content\n  },\n  watch: {\n    content (newValue) {\n      this.$refs.content.innerHTML = newValue\n    }\n  }\n})\nexport default class PostPageLevel extends Vue {}\n</script>\n\n<style scope>\n.level-box{\n  display: flex;\n  flex-direction: row;\n  justify-items: stretch;\n  align-items: stretch;\n  margin: -20px;\n}\n\n.level-box-left{\n  background-color: rgb(247, 249, 251);\n  min-height: 300px;\n  border-right: 1px solid #EBEEF5;\n}\n\n.level-box-right{\n  width: 100%;\n  padding: 15px;\n  display: flex;\n  flex-direction: column;\n}\n\n.level-box-user-avatar{\n  margin: 50px;\n  margin-top: 75px;\n  margin-bottom: 15px;\n}\n\n.level-box-user-name-container{\n  text-align: center;\n}\n\n.level-box-user-name{\n  margin-bottom: 15px;\n}\n\n.level-box-corner{\n  margin-top: auto;\n  text-align: right;\n}\n\n</style>\n","import { render } from \"./PostPageLevel.vue?vue&type=template&id=f3e137fc\"\nimport script from \"./PostPageLevel.vue?vue&type=script&lang=js\"\nexport * from \"./PostPageLevel.vue?vue&type=script&lang=js\"\n\nimport \"./PostPageLevel.vue?vue&type=style&index=0&id=f3e137fc&scope=true&lang=css\"\nscript.render = render\n\nexport default script","\nimport APIs from '@/APIs'\nimport { Options, Vue } from 'vue-class-component'\nimport RichTextEditor from '@/components/RichTextEditor.vue'\nimport PostPageLevel from '@/components/PostPageLevel.vue'\nimport { ElMessage } from 'element-plus'\n\n@Options({\n  components: {\n    'rich-text-editor': RichTextEditor,\n    'post-page-level': PostPageLevel\n  },\n  data () {\n    return {\n      title: '',\n      postId: '',\n      currentPage: 1,\n      replyBoxTextArea: '',\n      isLoadingPage: false,\n      levelList: [],\n      levelNum: 0,\n      pageSize: 2\n    }\n  },\n  created () {\n    this.$watch(\n      () => this.$route.query,\n      () => {\n        if (this.$route.path === '/post') {\n          this.loadLevels()\n        }\n      }\n    )\n  },\n  mounted () {\n    this.loadLevels()\n  },\n  methods: {\n    onReply () {\n      if (this.replyBoxTextArea === '') {\n        ElMessage.error('The reply content mustn\\'t be empty!')\n        return\n      }\n\n      APIs.reply(this.postId, this.replyBoxTextArea).then(() => {\n        ElMessage.success('You\\'ve just replied in a post')\n        this.replyBoxTextArea = ''\n        const newPage = Math.ceil((this.levelNum + 1) / this.pageSize)\n        if (this.currentPage !== newPage) {\n          this.$router.push(`/post?post_id=${this.postId}&page=${newPage}`)\n        } else {\n          this.loadLevels()\n        }\n      }).catch((e) => {\n        ElMessage.error('Can\\'t reply. ' + e)\n      })\n    },\n    onReplyTextClicked () {\n      window.scroll({ top: document.body.clientHeight, left: 0, behavior: 'smooth' })\n    },\n    loadLevels () {\n      this.postId = this.$route.query.post_id\n      let currentPage = Number.parseInt(this.$route.query.page)\n      if (!currentPage) {\n        currentPage = 1\n      }\n\n      this.isLoadingPage = true\n\n      APIs.getPostInfo(this.postId).then((value) => {\n        const v = value as {levelNum:number, title:string}\n        this.levelNum = v.levelNum\n        this.title = v.title\n        this.currentPage = currentPage\n        return APIs.getPostLevelList(this.postId, this.pageSize, this.currentPage)\n      }).catch((e) => {\n        ElMessage.error('Error happing while loading post page. ' + e)\n      }).then((v) => {\n        this.levelList = v\n      }).then(() => {\n        this.isLoadingPage = false\n      })\n    },\n    onCurrentPageChanged (pageNumber:number) {\n      this.$router.push(`/post?post_id=${this.postId}&page=${pageNumber}`)\n    }\n  }\n})\nexport default class PostPage extends Vue {}\n","import { render } from \"./PostPage.vue?vue&type=template&id=21caf426\"\nimport script from \"./PostPage.vue?vue&type=script&lang=ts\"\nexport * from \"./PostPage.vue?vue&type=script&lang=ts\"\n\nimport \"./PostPage.vue?vue&type=style&index=0&id=21caf426&scope=true&lang=css\"\nscript.render = render\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PostPageLevel.vue?vue&type=style&index=0&id=f3e137fc&scope=true&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PostPage.vue?vue&type=style&index=0&id=21caf426&scope=true&lang=css\""],"sourceRoot":""}